
import * as fs from 'fs';
import * as path from 'path';

// Mocking the Surah data structure from surahs.ts for standalone execution
const SURAH_TEXTS: Record<number, string[]> = {
    1: ["بِسْمِ ٱللَّهِ ٱلرَّحْمَـٰنِ ٱلرَّحِيمِ", "ٱلْحَمْدُ لِلَّهِ رَبِّ ٱلْعَـٰلَمِينَ", "ٱلرَّحْمَـٰنِ ٱلرَّحِيمِ", "مَـٰلِكِ يَوْمِ ٱلدِّينِ", "إِيَّاكَ نَعْبُدُ وَإِيَّاكَ نَسْتَعِينُ", "ٱهْدِنَا ٱلصِّرَٰطَ ٱلْمُسْتَقِيمَ", "صِرَٰطَ ٱلَّذِينَ أَنْعَمْتَ عَلَيْهِمْ غَيْرِ ٱلْمَغْضُوبِ عَلَيْهِمْ وَلَا ٱلضَّآلِّينَ"],
    95: ["وَٱلتِّينِ وَٱلزَّيْتُونِ", "وَطُورِ سِينِينَ", "وَهَـٰذَا ٱلْبَلَدِ ٱلْأَمِينِ", "لَقَدْ خَلَقْنَا ٱلْإِنسَـٰنَ فِى أَحْسَنِ تَقْوِيمٍ", "ثُمَّ رَدَدْنَـٰهُ أَسْفَلَ سَـٰفِلِينَ", "إِلَّا ٱلَّذِينَ ءَامَنُوا۟ وَعَمِلُوا۟ ٱلصَّـٰلِحَـٰتِ فَلَهُمْ أَجْرٌ غَيْرُ مَمْنُونٍ", "فَمَا يُكَذِّبُكَ بَعْدُ بِٱلدِّينِ", "أَلَيْسَ ٱللَّهُ بِأَحْكَمِ ٱلْحَـٰكِمِينَ"],
    96: ["ٱقْرَأْ بِٱسْمِ رَبِّكَ ٱلَّذِى خَلَقَ", "خَلَقَ ٱلْإِنسَـٰنَ مِنْ عَلَقٍ", "ٱقْرَأْ وَرَبُّكَ ٱلْأَكْرَمُ", "ٱلَّذِى عَلَّمَ بِٱلْقَلَمِ", "عَلَّمَ ٱلْإِنسَـٰنَ مَا لَمْ يَعْلَمْ", "كَلَّآ إِنَّ ٱلْإِنسَـٰنَ لَيَطْغَىٰٓ", "أَن رَّءَاهُ ٱسْتَغْنَىٰٓ", "إِنَّ إِلَىٰ رَبِّكَ ٱلرُّجْعَىٰ", "أَرَءَيْتَ ٱلَّذِى يَنْهَىٰ", "عَبْدًا إِذَا صَلَّىٰٓ", "أَرَءَيْتَ إِن كَانَ عَلَى ٱلْهُدَىٰٓ", "أَوْ أَمَرَ بِٱلتَّقْوَىٰٓ", "أَرَءَيْتَ إِن كَذَّبَ وَتَوَّلَّىٰٓ", "أَلَمْ يَعْلَم بِأَنَّ ٱللَّهَ يَرَىٰ", "كَلَّا لَئِن لَّمْ يَنتَهِ لَنَسْفَعًۢا بِٱلنَّاصِيَةِ", "نَاصِيَةٍ كَـٰذِبَةٍ خَاطِئَةٍ", "فَلْيَدْعُ نَادِيَهُۥ", "سَنَدْعُ ٱلزَّبَانِيَةَ", "كَلَّا لَا تُطِعْهُ وَٱسْجُدْ وَٱقْتَرِب"],
    97: ["إِنَّآ أَنزَلْنَـٰهُ فِى لَيْلَةِ ٱلْقَدْرِ", "وَمَآ أَدْرَىٰكَ مَا لَيْلَةُ ٱلْقَدْرِ", "لَيْلَةُ ٱلْقَدْرِ خَيْرٌ مِّنْ أَلْفِ شَهْرٍ", "تَنَزَّلُ ٱلْمَلَـٰٓئِكَةُ وَٱلرُّوحُ فِيهَا بِإِذْنِ رَبِّهِم مِّن كُلِّ أَمْرٍ", "سَلَـٰمٌ هِىَ حَتَّىٰ مَطْلَعِ ٱلْفَجْرِ"],
    98: ["لَمْ يَكُنِ ٱلَّذِينَ كَفَرُوا۟ مِنْ أَهْلِ ٱلْكِتَـٰبِ وَٱلْمُشْرِكِينَ مُنفَكِّينَ حَتَّىٰ تَأْتِيَهُمُ ٱلْبَيِّنَةُ", "رَسُولٌ مِّنَ ٱللَّهِ يَتْلُوا۟ صُحُفًا مُّطَهَّرَةً", "فِيهَا كُتُبٌ قَيِّمَةٌ", "وَمَا تَفَرَّقَ ٱلَّذِينَ أُوتُوا۟ ٱلْكِتَـٰبَ إِلَّا مِنۢ بَعْدِ مَا جَآءَتْهُمُ ٱلْبَيِّنَةُ", "وَمَآ أُمِرُوٓا۟ إِلَّا لِيَعْبُدُوا۟ ٱللَّهَ مُخْلِصِينَ لَهُ ٱلدِّينَ حُنَفَآءَ وَيُقِيمُوا۟ ٱلصَّلَوٰةَ وَيُؤْتُوا۟ ٱلزَّكَوٰةَ ۚ وَذَٰلِكَ دِينُ ٱلْقَيِّمَةِ", "إِنَّ ٱلَّذِينَ كَفَرُوا۟ مِنْ أَهْلِ ٱلْكِتَـٰبِ وَٱلْمُشْرِكِينَ فِى نَارِ جَهَنَّمَ خَـٰلِدِينَ فِيهَآ ۚ أُو۟لَـٰٓئِكَ هُمْ شَرُّ ٱلْبَرِيَّةِ", "إِنَّ ٱلَّذِينَ ءَامَنُوا۟ وَعَمِلُوا۟ ٱلصَّـٰلِحَـٰتِ أُو۟لَـٰٓئِكَ هُمْ خَيْرُ ٱلْبَرِيَّةِ", "جَزَآؤُهُمْ عِندَ رَبِّهِمْ جَنَّـٰتُ عَدْنٍ تَجْرِى مِن تَحْتِهَا ٱلْأَنْهَـٰرُ خَـٰلِدِينَ فِيهَآ أَبَدًا ۚ رَّضِىَ ٱللَّهُ عَنْهُمْ وَرَضُوا۟ عَنْهُ ۚ ذَٰلِكَ لِمَنْ خَشِىَ رَبَّهُۥ"],
    99: ["إِذَا زُلْزِلَتِ ٱلْأَرْضُ زِلْزَالَهَا", "وَأَخْرَجَتِ ٱلْأَرْضُ أَثْقَالَهَا", "وَقَالَ ٱلْإِنسَـٰنُ مَا لَهَا", "يَوْمَئِذٍ تُحَدِّثُ أَخْبَارَهَا", "بِأَنَّ رَبَّكَ أَوْحَىٰ لَهَا", "يَوْمَئِذٍ يَصْدُرُ ٱلنَّاسُ أَشْتَاتًا لِّيُرَوْا۟ أَعْمَـٰلَهُمْ", "فَمَن يَعْمَلْ مِثْقَالَ ذَرَّةٍ خَيْرًا يَرَهُۥ", "وَمَن يَعْمَلْ مِثْقَالَ ذَرَّةٍ شَرًّا يَرَهُۥ"],
    100: ["وَٱلْعَـٰدِيَـٰتِ ضَبْحًا", "فَٱلْمُورِيَـٰتِ قَدْحًا", "فَٱلْمُغِيرَٰتِ صُبْحًا", "فَأَثَرْنَ بِهِۦ نَقْعًا", "فَوَسَطْنَ بِهِۦ جَمْعًا", "إِنَّ ٱلْإِنسَـٰنَ لِرَبِّهِۦ لَكَنُودٌ", "وَإِنَّهُۥ عَلَىٰ ذَٰلِكَ لَشَهِيدٌ", "وَإِنَّهُۥ لِحُبِّ ٱلْخَيْرِ لَشَدِيدٌ", "أَفَلَا يَعْلَمُ إِذَا بُعْثِرَ مَا فِى ٱلْقُبُورِ", "وَحُصِّلَ مَا فِى ٱلصُّدُورِ", "إِنَّ رَبَّهُم بِهِمْ يَوْمَئِذٍ لَّخَبِيرٌۢ"],
    101: ["ٱلْقَارِعَةُ", "مَا ٱلْقَارِعَةُ", "وَمَآ أَدْرَىٰكَ مَا ٱلْقَارِعَةُ", "يَوْمَ يَكُونُ ٱلنَّاسُ كَٱلْفَرَاشِ ٱلْمَبْثُوثِ", "وَتَكُونُ ٱلْجِبَالُ كَٱلْعِهْنِ ٱلْمَنفُوشِ", "فَأَمَّا مَن ثَقُلَتْ مَوَٰزِينُهُۥ", "فَهُوَ فِى عِيشَةٍ رَّاضِيَةٍ", "وَأَمَّا مَنْ خَفَّتْ مَوَٰزِينُهُۥ", "فَأُمُّهُۥ هَاوِيَةٌ", "وَمَآ أَدْرَىٰكَ مَا هِيَهْ", "نَارٌ حَامِيَةٌۢ"],
    102: ["أَلْهَىٰكُمُ ٱلتَّكَاثُرُ", "حَتَّىٰ زُرْتُمُ ٱلْمَقَابِرَ", "كَلَّا سَوْفَ تَعْلَمُونَ", "ثُمَّ كَلَّا سَوْفَ تَعْلَمُونَ", "كَلَّا لَوْ تَعْلَمُونَ عِلْمَ ٱلْيَقِينِ", "لَتَرَوُنَّ ٱلْجَحِيمَ", "ثُمَّ لَتَرَوُنَّهَا عَيْنَ ٱلْيَقِينِ", "ثُمَّ لَتُسْـَٔلُنَّ يَوْمَئِذٍ عَنِ ٱلنَّعِيمِ"],
    103: ["وَٱلْعَصْرِ", "إِنَّ ٱلْإِنسَـٰنَ لَفِى خُسْرٍ", "إِلَّا ٱلَّذِينَ ءَامَنُوا۟ وَعَمِلُوا۟ ٱلصَّـٰلِحَـٰتِ وَتَوَاصَوْا۟ بِٱلْحَقِّ وَتَوَاصَوْا۟ بِٱلصَّبْرِ"],
    104: ["وَيْلٌ لِّكُلِّ هُمَزَةٍ لُّمَزَةٍ", "ٱلَّذِى جَمَعَ مَالًا وَعَدَّدَهُۥ", "يَحْسَبُ أَنَّ مَالَهُۥٓ أَخْلَدَهُۥ", "كَلَّا ۖ لَيُنۢبَذَنَّ فِى ٱلْحُطَمَةِ", "وَمَآ أَدْرَىٰكَ مَا ٱلْحُطَمَةُ", "نَارُ ٱللَّهِ ٱلْمُوقَدَةُ", "ٱلَّتِى تَطَّلِعُ عَلَى ٱلْأَفْئِدَةِ", "إِنَّهَا عَلَيْهِم مُّؤْصَدَةٌ", "فِى عَمَدٍ مُّمَدَّدَةٍۭ"],
    105: ["أَلَمْ تَرَ كَيْفَ فَعَلَ رَبُّكَ بِأَصْحَـٰبِ ٱلْفِيلِ", "أَلَمْ يَجْعَلْ كَيْدَهُمْ فِى تَضْلِيلٍ", "وَأَرْسَلَ عَلَيْهِمْ طَيْرًا أَبَابِيلَ", "تَرْمِيهِم بِحِجَارَةٍ مِّن سِجِّيلٍ", "فَجَعَلَهُمْ كَعَصْفٍ مَّأْكُولٍۭ"],
    106: ["لِإِيلَافِ قُرَيْشٍ", "إِۦلَـٰفِهِمْ رِحْلَةَ ٱلشِّتَآءِ وَٱلصَّيْفِ", "فَلْيَعْبُدُوا۟ رَبَّ هَـٰذَا ٱلْبَيْتِ", "ٱلَّذِىٓ أَطْعَمَهُم مِّن جُوعٍ وَءَامَنَهُم مِّنْ خَوْفٍۭ"],
    107: ["أَرَءَيْتَ ٱلَّذِى يُكَذِّبُ بِٱلدِّينِ", "فَذَٰلِكَ ٱلَّذِى يَدُعُّ ٱلْيَتِيمَ", "وَلَا يَحُضُّ عَلَىٰ طَعَامِ ٱلْمِسْكِينِ", "فَوَيْلٌ لِّلْمُصَلِّينَ", "ٱلَّذِينَ هُمْ عَن صَلَاتِهِمْ سَاهُونَ", "ٱلَّذِينَ هُمْ يُرَآءُونَ", "وَيَمْنَعُونَ ٱلْمَاعُونَ"],
    108: ["إِنَّآ أَعْطَيْنَـٰكَ ٱلْكَوْثَرَ", "فَصَلِّ لِرَبِّكَ وَٱنْحَرْ", "إِنَّ شَانِئَكَ هُوَ ٱلْأَبْتَرُ"],
    109: ["قُلْ يَـٰٓأَيُّهَا ٱلْكَـٰفِرُونَ", "لَآ أَعْبُدُ مَا تَعْبُدُونَ", "وَلَآ أَنتُمْ عَـٰبِدُونَ مَآ أَعْبُدُ", "وَلَآ أَنَا۠ عَابِدٌ مَّا عَبَدتُّمْ", "وَلَآ أَنتُمْ عَـٰبِدُونَ مَآ أَعْبُدُ", "لَكُمْ دِينُكُمْ وَلِىَ دِينِ"],
    110: ["إِذَا جَآءَ نَصْرُ ٱللَّهِ وَٱلْفَتْحُ", "وَرَأَيْتَ ٱلنَّاسَ يَدْخُلُونَ فِى دِينِ ٱللَّهِ أَفْوَاجًا", "فَسَبِّحْ بِحَمْدِ رَبِّكَ وَٱسْتَغْفِرْهُ ۚ إِنَّهُۥ كَانَ تَوَّابًۢا"],
    111: ["تَبَّتْ يَدَآ أَبِى لَهَبٍ وَتَبَّ", "مَآ أَغْنَىٰ عَنْهُ مَالُهُۥ وَمَا كَسَبَ", "سَيَصْلَىٰ نَارًا ذَاتَ لَهَبٍ", "وَٱمْرَأَتُهُۥ حَمَّالَةَ ٱلْحَطَبِ", "فِى جِيدِهَا حَبْلٌ مِّن مَّسَدٍۭ"],
    112: ["قُلْ هُوَ ٱللَّهُ أَحَدٌ", "ٱللَّهُ ٱلصَّمَدُ", "لَمْ يَلِدْ وَلَمْ يُولَدْ", "وَلَمْ يَكُن لَّهُۥ كُفُوًا أَحَدٌۭ"],
    113: ["قُلْ أَعُوذُ بِرَبِّ ٱلْفَلَقِ", "مِن شَرِّ مَا خَلَقَ", "وَمِن شَرِّ غَاسِقٍ إِذَا وَقَبَ", "وَمِن شَرِّ ٱلنَّفَّـٰثَـٰتِ فِى ٱلْعُقَدِ", "وَمِن شَرِّ حَاسِدٍ إِذَا حَسَدَ"],
    114: ["قُلْ أَعُوذُ بِرَبِّ ٱلنَّاسِ", "مَلِكِ ٱلنَّاسِ", "إِلَـٰهِ ٱلنَّاسِ", "مِن شَرِّ ٱلْوَسْوَاسِ ٱلْخَنَّاسِ", "ٱلَّذِى يُوَسْوِسُ فِى صُدُورِ ٱلنَّاسِ", "مِنَ ٱلْجِنَّةِ وَٱلنَّاسِ"]
};

// Regex patterns
const RB = {
    ghunnah: /([نم][\u0640-\u065f]*\u0651)/,
    qalqala: /([قطبجد][\u0640-\u065f]*\u0652)/,
    madd_general: /([اوي][\u0640-\u065f]*\u0653)|آ/,
    ikhfa: /ن(?!\u0652|\u0651)/,
};

const results: Record<string, any[]> = {
    ghunnah: [],
    qalqala: [],
    madd: [],
    all_words: []
};

Object.entries(SURAH_TEXTS).forEach(([surahId, ayahs]) => {
    ayahs.forEach((ayahText, ayahIdx) => {
        const words = ayahText.split(/\s+/);
        words.forEach((word, wordIdx) => {
            // Debug specific word 'An-Nas'
            if (word.includes('ٱلنَّاسِ')) {
                console.error(`DEBUG: ٱلنَّاسِ found. Codes: ${word.split('').map(c => c.charCodeAt(0).toString(16)).join(' ')}`);
                console.error(`Regex Test Ghunnah: ${RB.ghunnah.test(word)}`);
            }
            const s = parseInt(surahId);
            const a = ayahIdx + 1;
            const w = wordIdx + 1;

            const entry = { text: word, s, a, w };
            results.all_words.push(entry);

            if (RB.ghunnah.test(word)) results.ghunnah.push(entry);
            if (RB.qalqala.test(word)) results.qalqala.push(entry);
            if (RB.madd_general.test(word)) results.madd.push(entry);
        });
    });
});

console.log(JSON.stringify(results));
